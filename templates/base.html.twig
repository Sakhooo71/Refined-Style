<!DOCTYPE html>
<html>
	<head>
		{# SEO meta tags 2026 #}
		<meta name="description" content="{% block meta_description %}Boutique tendance, mode et lifestyle 2026. Découvrez nos collections, offres et produits exclusifs.{% endblock %}">
		<meta name="keywords" content="{% block meta_keywords %}mode, boutique, ecommerce, tendance, 2026, collections, offres, produits{% endblock %}">
		<meta property="og:title" content="{% block og_title %}{% block title %}Welcome!{% endblock %}{% endblock %}">
		<meta property="og:description" content="{% block og_description %}Boutique tendance, mode et lifestyle 2026. Découvrez nos collections, offres et produits exclusifs.{% endblock %}">
		<meta property="og:image" content="{{ asset('images/logo.png') }}">
		<meta property="og:url" content="{{ app.request ? app.request.uri : '' }}">
		<meta name="robots" content="index, follow">
		<meta charset="UTF-8">
		<title>
			{% block title %}Welcome!
			{% endblock %}
		</title>
		<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">
		{% block stylesheets %}
			<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
			<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
			<link rel="preconnect" href="https://fonts.googleapis.com">
			<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
			<link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
			<link rel="stylesheet" href="{{ asset('styles/app.css') }}">
			<style>
				.dark-mode {
					background: #181824 !important;
					color: #e0e0e0 !important;
				}
				.dark-mode .navbar {
					background-color: #232336 !important;
				}
				.dark-mode a, .dark-mode .navbar a, .dark-mode .navbar button {
					color: #EEE029 !important;
				}
				.dark-mode .card, .dark-mode .modal-content {
					background: #232336 !important;
					color: #e0e0e0 !important;
				}
			</style>
			
		
		{% endblock %}

		{% block javascripts %}
			<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
			{% block importmap %}
				{{ importmap('app') }}
			{% endblock %}
		{% endblock %}
	</head>
			<!-- Plausible Analytics (RGPD friendly) -->
			<script defer data-domain="refined-style.example.com" src="https://plausible.io/js/plausible.js"></script>
	<body>
		<!-- Bouton accessibilité -->
		<div style="position:fixed;top:60px;right:20px;z-index:2000">
			<button id="accessibilityToggle" class="btn btn-outline-warning btn-sm" aria-pressed="false" aria-label="Activer le mode accessibilité">
				<i class="bi bi-universal-access"></i> Accessibilité
			</button>
		</div>
		<!-- Toast notifications -->
		<div id="toastContainer2026" style="position:fixed;top:30px;right:30px;z-index:4000;"></div>
			<!-- Loader animé moderne -->
			<div id="globalLoader" style="position:fixed;z-index:3000;top:0;left:0;width:100vw;height:100vh;background:rgba(24,24,36,0.95);display:flex;align-items:center;justify-content:center;transition:opacity 0.4s;">
				<div class="loader-2026">
					<div></div><div></div><div></div><div></div>
				</div>
			</div>

		<style>

			
		</style>

		<div class="index">
			<!-- Bouton Dark Mode -->
			<div style="position:fixed;top:10px;right:20px;z-index:2000">
				<button id="darkModeToggle" class="btn btn-outline-secondary btn-sm">
					<i class="bi bi-moon"></i> Mode sombre
				</button>
			</div>

			<nav class="navbar navbar-expand-lg navbar-light sticky-top p-3">
				<div class="container-fluid">
					<a href="{{ path('app_default') }}" class="navbar-brand d-none d-lg-block" aria-label="Accueil"><img src="{{ asset('images/logo.png') }}" alt="Logo Refined Style" width="34px" loading="lazy"></a>
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse" id="navbarNavAltMarkup">
						<ul class="navbar-nav me-auto mb-2 mb-lg-0">
							<li class="nav-item">
								<a href="{{ path('app_default') }}" class="nav-link">Home</a>
							</li>
							<li class="nav-item">
								<a href="{{ path('app_categories') }}" class="nav-link">Collections</a>
							</li>
							<li class="nav-item">
								<a href="{{ path('app_products') }}" class="nav-link">Products</a>
							</li>
							<li class="nav-item">
								<a href="{{ path('app_products_offers') }}" class="nav-link">Offers</a>
							</li>

						</ul>
					</div>
					<div class="d-flex">
						<ul class="d-flex mb-2 mb-lg-0 my-navbar">
							<li class="nav-item mx-3">
								<a href="{{ path('app_favorite') }}" class="nav-link">

									<i class="fas fa-heart mx-1"></i>
									Favorites
								</a>
							</li>
							<li class="nav-item dropdown mx-3">
								<a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
									<i class="fas fa-user"></i>
									<span id="username">
										{{ app.user ? (app.user.firstName ) : 'My account' }}
									</span>
								</a>
								<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">

									{% if not app.user %}
										<li>
											<a class="dropdown-item" href="{{ path('app_register') }}">Sign Up</a>
										</li>
										<li>
											<a class="dropdown-item" href="{{ path('app_login') }}">Log In</a>
										</li>
									{% endif %}

									{% if app.user %}
										<li>
											<a class="dropdown-item" href="{{ path('user_profile') }}">My Profile</a>
										</li>
										<li>
											<a class="dropdown-item" href="{{ path('app_address_index') }}">My addresses</a>
										</li>
										<li>
											<a class="dropdown-item" href="{{ path('user_orders') }}">My Orders</a>
										</li>

									{% endif %}
									{% if app.user and 'ROLE_ADMIN' in app.user.roles %}
										<li>
											<a class="dropdown-item" href="{{ path('admin_orders') }}">All Orders</a>
										</li>
										<li>
											<a class="dropdown-item" href="{{ path('admin') }}" id="dashboard">Dashboard</a>
										</li>
									{% endif %}


									{% if app.user %}
										<li>
											<a class="dropdown-item" href="{{ path('app_logout') }}">Log Out</a>
										</li>
									{% endif %}

								</ul>
							</li>

							<li class="nav-item mx-3">
								<a href="{{ path('app_cart') }}" class="nav-link">
									<i class="fas fa-shopping-cart mx-1"></i>Cart
									<span>({{ totalQuantity() }})</span>
								</a>
							</li>


						</ul>
					</div>
				</div>
			</nav>
		</div>

		{% block body %}{% endblock %}


		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
			<script>
			// Mode accessibilité : contraste élevé et grosses polices
			$(function() {
				const a11yKey = 'a11yMode2026';
				function setA11yMode(on) {
					if(on) {
						$('body').addClass('a11y-mode');
						localStorage.setItem(a11yKey, '1');
					} else {
						$('body').removeClass('a11y-mode');
						localStorage.removeItem(a11yKey);
					}
				}
				$('#accessibilityToggle').on('click', function() {
					setA11yMode(!$('body').hasClass('a11y-mode'));
				});
				if(localStorage.getItem(a11yKey)) {
					setA11yMode(true);
				}
			});
			</script>
			<script>
			// Toast notification system 2026
			function showToast2026(message, type = 'success', duration = 3500) {
				const container = document.getElementById('toastContainer2026');
				if (!container) return;
				const toast = document.createElement('div');
				toast.className = `toast-2026 toast-2026-${type}`;
				toast.innerHTML = `<span>${message}</span><button onclick="this.parentNode.remove()" class="toast-2026-close">&times;</button>`;
				container.appendChild(toast);
				toast.querySelector('.toast-2026-close').setAttribute('aria-label', 'Fermer la notification');
				setTimeout(() => { toast.style.opacity = 0; setTimeout(() => toast.remove(), 400); }, duration);
			}
			</script>
				<script>
				// Loader animé moderne 2026
				window.addEventListener('load', function() {
					const loader = document.getElementById('globalLoader');
					if(loader) {
						loader.style.opacity = 0;
						setTimeout(() => loader.style.display = 'none', 400);
					}
				});
				</script>
		<script>
		// Dark mode toggle
		$(function() {
			const darkModeKey = 'darkMode2026';
			function setDarkMode(on) {
				if(on) {
					$('body').addClass('dark-mode');
					localStorage.setItem(darkModeKey, '1');
				} else {
					$('body').removeClass('dark-mode');
					localStorage.removeItem(darkModeKey);
				}
			}
			$('#darkModeToggle').on('click', function() {
				setDarkMode(!$('body').hasClass('dark-mode'));
			});
			if(localStorage.getItem(darkModeKey)) {
				setDarkMode(true);
			}
		});
		</script>
		<script>
		$(document).ready(function() {
    $('.ajax-form').on('submit', function(e) {
        e.preventDefault();
        let $form = $(this);
        $.post($form.attr('action'), $form.serialize(), function(response) {
            if (response.success) {
                location.reload();
            } else {
                alert('An error occurred!');
            }
        });
    });
});

function adjustQuantity (action, productId) {
    let url = (action === 'increment') ? '/cart/increment/' + productId : '/cart/decrement/' + productId;

	fetch(url, {method: 'POST'}).then(response => response.json()).then(data => {
		if (data.success) {
			location.reload();
		} else {
			showToast2026(data.message || 'Erreur lors de la modification du panier', 'error');
		}
	});
}

function removeFromCart (productId) {
	fetch('/cart/remove/' + productId, {method: 'POST'}).then(response => response.json()).then(data => {
		if (data.success) {
			location.reload();
		} else {
			showToast2026(data.message || 'Erreur lors de la suppression du panier', 'error');
		}
	});
}

function clearCart () {
	fetch('/cart/clear', {method: 'POST'}).then(response => response.json()).then(data => {
		if (data.success) {
			location.reload();
		} else {
			showToast2026(data.message || 'Erreur lors du vidage du panier', 'error');
		}
	});
}

function addToFavorites (productId) {
	fetch('/favorite/add/' + productId, {method: 'POST'}).then(response => response.json()).then(data => {
		if (data.success) {
			location.reload();
		} else {
			showToast2026(data.message || 'Erreur lors de l\'ajout aux favoris', 'error');
		}
	});
}


function removeFromFavorites (productId) {
	fetch('/favorite/remove/' + productId, {method: 'POST'}).then(response => response.json()).then(data => {
		if (data.success) {
			location.reload();
		} else {
			showToast2026(data.message || 'Erreur lors du retrait des favoris', 'error');
		}
	});
}

$(document).ready(function() {

    // Hide payment section and PayPal button by default
    $('#paymentSection').hide();
    $('#paypal-button').hide();
    $('#cardDetails').hide();

    // Toggle visibility of the other addresses
    $('#toggleAddresses').click(function(event) {
        event.preventDefault(); // Prevent default action (like page reload or navigating to another page)
        $('#otherAddresses').slideToggle(); // Toggle visibility of the other addresses
    });

    // Listen for changes on the radio button selection for addresses
    $('input[name="selectedAddress"]').change(function() {
        if ($(this).is(':checked')) {
            // Show payment section when an address is selected
            $('#paymentSection').show();
        }
    });

    // Listen for changes on the radio button selection for payment methods
    $("input[name='paymentMethod']").change(function() {
        if ($('#stripePayment').is(':checked')) {
            // Show Stripe's "proceed to checkout" button and hide PayPal button
            $('#cardDetails').show();
            $('#paypal-button').hide();
        } else if ($('#paypalPayment').is(':checked')) {
            // Show PayPal button and hide Stripe's "proceed to checkout" button
            $('#paypal-button').show();
            $('#cardDetails').hide();
        }
    });
});

		</script>
	</body>
		<!-- Bottom navigation mobile -->
		<nav id="bottomNav2026" class="bottom-nav-2026 d-md-none">
			<a href="{{ path('app_default') }}" aria-label="Accueil"><i class="bi bi-house"></i><span>Accueil</span></a>
			<a href="{{ path('app_categories') }}" aria-label="Collections"><i class="bi bi-grid"></i><span>Collections</span></a>
			<a href="{{ path('app_products') }}" aria-label="Produits"><i class="bi bi-bag"></i><span>Produits</span></a>
			<a href="{{ path('app_favorite') }}" aria-label="Favoris"><i class="bi bi-heart"></i><span>Favoris</span></a>
			<a href="{{ path('app_cart') }}" aria-label="Panier"><i class="bi bi-cart"></i><span>Panier</span></a>
		</nav>
</html>
